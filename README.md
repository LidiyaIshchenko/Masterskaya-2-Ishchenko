# Поиск наиболее похожих товаров

## Введение

Заказчик предоставил анонимизированный набор имеющихся на складах товаров и набор новых товаров, для которых необходимо найти наиболее похожие из имеющегося набора. 
Особенность задачи состоит в том, что автоматический подбор похожих товаров должен производиться так, чтобы симулировать работу экспертов. Образцы их ответов предоставлены для обучения модели в отдельном файле вместе с примерами запросов.

## Описание данных
- <u>base.csv</u> - анонимизированный **набор товаров**. Каждый товар представлен как уникальный id (0-base, 1-base, 2-base) и вектор признаков размерностью 72.

- <u>train.csv</u> - **обучающий датасет**. Каждая строчка - один товар, для которого известен уникальный id (0-query, …, 100000-query), вектор признаков и id товара из base.csv, который максимально похож на него по мнению экспертов.

- <u>validation.csv</u> - **датасет с товарами** (уникальный id и вектор признаков), **для которых надо найти наиболее близкие** товары из base.csv.

- <u>validation_answer.csv</u> - **правильные ответы** к датасету с товарами для поиска (даётся **для оценки** работы простроенной **модели**).

## Задачи
- **разработать алгоритм**, который для всех товаров из validation.csv предложит несколько вариантов наиболее похожих товаров из base.csv;
- **оценить качество алгоритма** по метрике **accuracy@5**.

## Вывод
1. В рамках исследования были представлены 3 набора данных:
- Пропусков и дубликатов нет ни в одном наборе.
- Данные в основном представлены непрерывными числовыми значениями, основная их доля очевидно имеет нормальное распределение. 
- Данные, которые явно не характеризуются нормальным распределением были исключены из анализа, т.к. такие данные вносят лишние шумы.
- Сильных корреляционных зависимостей не выявлено.

2. Учитывая тот факт, что формула для расчёта расстояния между точками в пространстве чувствительна к диапазону значений различных характеристик, данные были нормализованы.

3. Дополнительно проанализирована целевая метрика в зависимости от количества кандидатов в диапозоне от 5 до 500 кандадатов и установлено:
- с увеличением количества кандидатов растет и максимальное значение целевой метрики
- увеличение количества кандидатов увеличит и время предсказания модели, так как ей придется в каждой иттерации просчитывать бОльшее количество кандидатов.

4. Для решения поставленной задачи было создано и наполнено векторное пространство из объектов анонамизированного набора данных (base). Пространство поделено на 20 кластеров, что ускоряет и уточняет процесс поиска. Для каждого объекта из train были найдены 10 ближайших векторов при помощи меры FlatL2 (при большом количестве не хватало оперативной памяти при формировании дататсетов для обучения и тестирования ML модели).

5. На тренировочном датасете (train) получаем значение метрики **accuracy@5=63.114**, что является удовлетворительным результатом работы модели. Такой результат удалось достичь за счет удалениея не информативных признаков и стандартизации данных. При этом на тестовой выборке (validation) значение метрики **accuracy@5= 62.96** достигнуто без учета ранжирования ML моделью.

6. В качестве ML модели был выбран CatBoostClassifier и проведен подбор гиперпараметров. По обученной модели пердсказаны вероятности совместимости и по найденным занчениям вероятностей  определены 5 наиболее подходящих кандидато по которым расчитано значение целевой метрики **accuracy@5=61.81**

**На текущем этапе мы видим, что применение ML модели не улучшает показатель целевой метрики, темне-менне в дальнейшем можно поробовать усовршенстовать модель и повторно сравнить результат**